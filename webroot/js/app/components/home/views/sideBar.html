<div class="sidebar-nav">
    <div class="panel-group" id="accordion">
        <ul id="nav-menu-1" class="nav nav-level-1 collapse in" role="tabpanel" data-level="1">
            <li ng-repeat="database in databaseList">
                <a title="{{database.dbName}}" class="accordion-toggle panel-heading collapsed" href="{{'#nav-menu-' + ($index + 2)}}" data-toggle="collapse" data-parent="#accordion">
                    <span>{{database.dbNameLabel}}</span>
                </a>
                <ul id="{{'nav-menu-' + ($index + 2)}}" class="nav nav-level-2 collapse" role="tabpanel" data-level="2" aria-expanded="false" style="height: 0px;">
                    <li ng-show="showSection(MENU_SECTIONS.template, database.dbRoles)">
                        <a class="accordion-toggle panel-heading collapsed" href="{{'#nav-menu-' + ((($index + 2) * 10) + 1)}}" data-toggle="collapse" data-parent="#accordion">
                            <span>Template</span>
                        </a>
                        <ul id="{{'nav-menu-' + ((($index + 2) * 10) + 1)}}" class="nav nav-level-3 collapse" role="tabpanel" data-level="3">
                            <li><a>Indicators</a></li>
                            <li><a>Units</a></li>
                            <li><a>Subgroups</a></li>
                            <li ui-sref-active="nav-active">
                                <a ng-click="setDatabase(database)" ui-sref="DataAdmin.home.templateIUS({dbId: database.id})">IUS</a></li>
                            <li><a>Indicator Classifications</a></li>
                            <li><a>Geographical Areas</a></li>
                            <li ui-sref-active="nav-active"><a ng-click="setDatabase(database)" ui-sref="DataAdmin.home.templateImportExport({dbId: database.id})">Import/Export</a></li>
                        </ul>
                    </li>
                    <li ng-show="showSection(MENU_SECTIONS.data, database.dbRoles)">
                        <a class="accordion-toggle panel-heading collapsed" href="{{'#nav-menu-' + ((($index + 2) * 10) + 2)}}" data-toggle="collapse" data-parent="#accordion">
                            <span>Data Entry</span>
                        </a>
                        <ul id="{{'nav-menu-' + ((($index + 2) * 10) + 2)}}" class="nav nav-level-3 collapse" role="tabpanel" data-level="3">
                            <li><a ng-click="setDatabase(database)" ui-sref="DataAdmin.home.dataEntry({dbId: database.id})">Enter Data</a></li>
                            <li><a>Import/Export</a></li>
                        </ul>
                    </li>
                    <li ng-show="showSection(MENU_SECTIONS.databaseSettings, database.dbRoles)">
                        <a class="accordion-toggle panel-heading collapsed" href="{{'#nav-menu-' + ((($index + 2) * 10) + 3)}}" data-toggle="collapse" data-parent="#accordion">
                            <span>Database Settings</span>
                        </a>
                        <ul id="{{'nav-menu-' + ((($index + 2) * 10) + 3)}}" class="nav nav-level-3 collapse" role="tabpanel" data-level="3">
                            <li><a>Settings</a></li>
                            <li ui-sref-active="nav-active"><a ng-click="setDatabase(database)" ui-sref="DataAdmin.home.userManagement({dbId: database.id})">User Management</a></li>
                            <li><a>Transaction Logs</a></li>
                        </ul>
                    </li>
                    <li ng-show="showSection(MENU_SECTIONS.publishData, database.dbRoles)">
                        <a>Publish Data</a>
                    </li>
                </ul>
            </li>
            <li ui-sref-active="nav-active">
                <a ui-sref="DataAdmin.home.manageDatabases">Manage Databases</a>
            </li>
        </ul>
    </div>
    <script type="text/javascript">
        $(document).ready(function() {
            $('#accordion').on('show.bs.collapse', function (e) {
                var target = e.target;
                var level = $(target).attr('data-level');
                var id = $(target).attr('id');
                $('[data-level=' + level + ']').each(function() {
                    if ($(this).attr('id') != id && $(this).hasClass('in') == true) {
                        $(this).collapse('hide');
                    }
                });
            })
        });
    </script>
</div>